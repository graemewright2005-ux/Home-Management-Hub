<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meal Recipes - Home Hub</title>
    <style>
        :root {
            --primary: #667eea;
            --primary-dark: #764ba2;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --text-dim: #cbd5e1;
            --border: #334155;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6;}
        .nav { background: var(--card); border-bottom: 1px solid var(--border); padding: 1rem 1.5rem; position: sticky; top: 0; z-index: 100;}
        .nav-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;}
        .nav-brand { font-size: 1.5rem; font-weight: 800; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;}
        .nav-toggle { display: none; background: none; border: none; color: var(--primary); font-size: 1.5rem; cursor: pointer; padding:0.5rem;}
        .nav-menu { display: flex; gap: 0.5rem; list-style: none;}
        .nav-menu a { padding:0.6rem 1.2rem; border-radius:8px; text-decoration:none; color:var(--text-dim); font-weight:600; font-size:0.95rem; transition:all 0.2s;}
        .nav-menu a:hover { background: rgba(102,126,234,0.1); color:var(--primary);}
        .nav-menu a.active { background: var(--gradient); color:white;}
        @media(max-width:768px){
            .nav-toggle{display:block;}
            .nav-menu{position:fixed;top:70px;left:0;right:0;background:var(--card);flex-direction:column;padding:1rem;transform:translateY(-100%);opacity:0;pointer-events:none;transition:all 0.3s;}
            .nav-menu.active{transform:translateY(0);opacity:1;pointer-events:all;}
            .nav-menu a{width:100%;}
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem 1.5rem;}
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;}
        h1 { font-size:2rem; background:var(--gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin: 0;}
        .btn { padding: 0.8rem 1.5rem; border: none; border-radius: 8px; font-weight: 600; cursor:pointer; transition:all 0.2s;}
        .btn-primary { background: var(--gradient); color:white;}
        .btn-primary:hover{transform:translateY(-2px);}
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px,1fr)); gap:1.5rem; margin-bottom:2rem;}
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        .card:hover { transform: translateY(-5px); border-color: var(--primary);}
        .card-img { width:100%; height:200px; background: var(--gradient); display: flex; align-items:center; justify-content:center; font-size:5rem;}
        .card-img img { width:100%; height:100%; object-fit: cover;}
        .fav { position:absolute;top:1rem;right:1rem; font-size:1.8rem; z-index:10;}
        .card-body { padding:1.2rem;}
        .card-title { font-size:1.2rem; font-weight:700; margin-bottom:0.5rem;}
        .tag { display:inline-block; padding:0.3rem 0.8rem; border-radius:6px; font-size:0.85rem; font-weight:600; margin:0.3rem 0.3rem 0.3rem 0;}
        .tag-type { background: rgba(102,126,234,0.15); color:#93c5fd; border:1px solid rgba(102,126,234,0.3);}
        .empty {text-align:center; padding:3rem 1rem; color:var(--text-dim);}
        .empty-icon {font-size:4rem; margin-bottom:1rem; opacity:0.4;}
        @media(max-width:480px){
            .grid { grid-template-columns: 1fr; }
            .header { flex-direction:column; align-items:flex-start;}
        }
        /* Modal styles */
        .modal { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.8); z-index:1000; align-items: center; justify-content: center; padding: 1rem;}
        .modal.active { display: flex;}
        .modal-content { background: var(--card); border-radius: 16px; max-width:620px; width:100%; max-height:90vh; overflow-y:auto;}
        .modal-header { padding:1.4rem; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center;}
        .modal-header h2 { margin: 0; background:var(--gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent;}
        .modal-close { background:none; border:none; font-size:2rem; color:var(--text-dim); cursor:pointer;}
        .modal-body { padding:1.5rem;}
        .modal-footer { padding:1rem 1.5rem; border-top:1px solid var(--border); display:flex; gap:0.5rem; justify-content:flex-end;}
        .meal-plan-add { margin-top:2rem; padding-top:1rem; border-top:1px solid var(--border);}
        .form-group { margin-bottom:1rem;}
        .form-group label { display:block; font-weight:600; margin-bottom:0.33rem;}
        .checks{display:flex; flex-wrap:wrap; gap:0.8rem;}
    </style>
</head>
<body>
<nav class="nav">
    <div class="nav-content">
        <div class="nav-brand">üè† Home Hub</div>
        <button class="nav-toggle" onclick="document.getElementById('navMenu').classList.toggle('active')">‚ò∞</button>
        <ul class="nav-menu" id="navMenu">
            <li><a href="../index.html">üìä Dashboard</a></li>
            <li><a href="meals.html" class="active">üçΩÔ∏è Meals</a></li>
            <li><a href="planner.html">üìÖ Planner</a></li>
            <li><a href="shopping.html">üõí Shopping</a></li>
            <li><a href="cleaning.html">üßπ Cleaning</a></li>
            <li><a href="maintenance.html">üõ†Ô∏è Maintenance</a></li>
            <li><a href="settings.html">‚öôÔ∏è Settings</a></li>
        </ul>
    </div>
</nav>
<div class="container">
    <div class="header">
        <h1>Meal Recipes</h1>
        <button class="btn btn-primary" onclick="openModal('add')">‚ûï Add Recipe</button>
    </div>
    <div class="grid" id="grid"></div>
    <div class="empty" id="empty" style="display:none;">
        <div class="empty-icon">üçΩÔ∏è</div>
        <h3>No meals found</h3>
        <p>Try adding a recipe or adjusting your filters</p>
    </div>
</div>

<div class="modal" id="viewModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="viewTitle"></h2>
            <button class="modal-close" onclick="closeModal('view')">&times;</button>
        </div>
        <div class="modal-body" id="viewBody"></div>
        <div class="meal-plan-add" id="mealPlanAdd"></div>
        <div class="modal-footer">
            <button class="btn btn-primary" onclick="closeModal('view')">Close</button>
        </div>
    </div>
</div>
<div class="modal" id="addModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Add Recipe</h2>
            <button class="modal-close" onclick="closeModal('add')">&times;</button>
        </div>
        <div class="modal-body">
            <form id="form" onsubmit="saveRecipe(event)">
                <div class="form-group">
                    <label>Title *</label>
                    <input type="text" id="title" required>
                </div>
                <div class="form-group">
                    <label>Type *</label>
                    <select id="type" required>
                        <option value="">Select type</option>
                        <option value="breakfast">Breakfast</option>
                        <option value="lunch">Lunch</option>
                        <option value="dinner">Dinner</option>
                        <option value="snack">Snack</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ingredients (one per line) *</label>
                    <textarea id="ingredients" required></textarea>
                </div>
                <div class="form-group">
                    <label>Instructions *</label>
                    <textarea id="instructions" required></textarea>
                </div>
                <div class="form-group">
                    <label class="check-label"><input type="checkbox" id="fav"> ‚≠ê Favourite</label>
                </div>
                <button class="btn btn-primary" type="submit">Save</button>
            </form>
        </div>
    </div>
</div>

<script>
const MEALS = JSON.parse(localStorage.getItem('hubMeals')||"[]");
function renderGrid(){
    const grid=document.getElementById('grid');
    const empty=document.getElementById('empty');
    grid.innerHTML = '';
    if(MEALS.length===0){
        grid.style.display='none';
        empty.style.display='block';
    }else{
        grid.style.display='grid';
        empty.style.display='none';
        grid.innerHTML = MEALS.map((m,idx)=>`
            <div class="card" onclick="viewMeal(${idx})">
                ${m.fav?'<div class="fav">‚≠ê</div>':''}
                <div class="card-img">${m.emoji||'üçΩÔ∏è'}</div>
                <div class="card-body">
                    <div class="card-title">${m.title}</div>
                    <span class="tag tag-type">${m.type}</span>
                    ${m.diet && m.diet.length ? m.diet.map(d=>`<span class="tag tag-type">${d.replace('-',' ')}</span>`).join(''):""}
                </div>
            </div>
        `).join('');
    }
}
function viewMeal(idx){
    let m = MEALS[idx];
    document.getElementById("viewTitle").textContent = m.title;
    document.getElementById("viewBody").innerHTML = `
        <div style="font-size:2em;margin-bottom:0.4em;">${m.emoji||'üçΩÔ∏è'}</div>
        <div><span class="tag tag-type">${m.type}</span>
            ${m.diet ? m.diet.map(d=>`<span class="tag tag-type">${d.replace('-',' ')}</span>`).join(''):''}
            ${m.fav ? '<span class="tag" style="background:gold;color:#222;">‚≠ê Favourite</span>':''}
        </div>
        <div style="margin-top:1em;"><strong>Ingredients:</strong><ul>${(m.ing||[]).map(i=>`<li>${i}</li>`).join('')}</ul></div>
        <div><strong>Instructions:</strong><p style="white-space:pre-wrap;">${m.instructions||""}</p></div>
    `;
    renderMealPlanAdd(idx);
    openModal('view');
}
function renderMealPlanAdd(mealIdx){
    const m = MEALS[mealIdx];
    // Add to meal plan + time selection
    document.getElementById('mealPlanAdd').innerHTML = `
        <form onsubmit="addMealToPlanner(event,${mealIdx})">
            <div style="font-weight:600;margin-bottom:0.5em;">Add to Weekly Meal Plan</div>
            <label for="daySelect">Day</label>
            <select id="daySelect" required style="margin-bottom:0.3em;">
                <option value="">Select Day</option>
                <option>Sunday</option><option>Monday</option><option>Tuesday</option>
                <option>Wednesday</option><option>Thursday</option><option>Friday</option><option>Saturday</option>
            </select>
            <label for="timeSelect">Meal Time</label>
            <select id="timeSelect" required style="margin-bottom:0.4em;">
                <option value="">Select</option>
                <option>Breakfast</option>
                <option>Lunch</option>
                <option>Dinner</option>
                <option>Snack</option>
            </select>
            <button class="btn btn-primary" type="submit">Add to Meal Plan</button>
        </form>
        <div style="margin-top:0.6em; font-size:0.97em; color: var(--text-dim);">Tip: You can assign any recipe to any meal/time for the week!</div>
    `;
}
function addMealToPlanner(e, mealIdx){
    e.preventDefault();
    const day = document.getElementById('daySelect').value;
    const time = document.getElementById('timeSelect').value;
    if(!day || !time) return;
    const m = MEALS[mealIdx];
    let planner = JSON.parse(localStorage.getItem('hubPlanner')||'[]');
    // Ensure full week structure (see planner.html data model)
    while(planner.length < 7){ planner.push({slots:{}});}
    let dayIdx = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(day);
    if(dayIdx<0) return alert("Invalid day selected!");
    if(!planner[dayIdx].slots) planner[dayIdx].slots={};
    planner[dayIdx].slots[time] = {...m};
    localStorage.setItem('hubPlanner', JSON.stringify(planner));
    alert(`Added "${m.title}" to ${day} / ${time}!`);
}
function openModal(id){ document.getElementById(id+'Modal').classList.add('active'); }
function closeModal(id){ document.getElementById(id+'Modal').classList.remove('active'); }
function saveRecipe(event){
    event.preventDefault();
    const newMeal = {
        id: "m"+Date.now()+Math.random().toString(16).slice(2),
        title: document.getElementById('title').value.trim(),
        type: document.getElementById('type').value,
        ing: document.getElementById('ingredients').value.split('\n').filter(x=>x.trim()),
        instructions: document.getElementById('instructions').value,
        fav: document.getElementById('fav').checked,
        emoji: "üçΩÔ∏è",
        diet: [],
    };
    MEALS.push(newMeal);
    localStorage.setItem('hubMeals', JSON.stringify(MEALS));
    document.getElementById('form').reset();
    closeModal('add');
    renderGrid();
    alert('Recipe added!');
}
window.addEventListener('DOMContentLoaded',()=>{
    renderGrid();
});
document.querySelectorAll('.modal').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)m.classList.remove('active')}));
document.addEventListener('keydown',e=>{if(e.key==='Escape')document.querySelectorAll('.modal').forEach(m=>m.classList.remove('active'))});
</script>
</body>
</html>
