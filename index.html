<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Dashboard - Home Hub</title>
    <style>
        :root {
            --primary: #667eea;
            --primary-dark: #764ba2;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --text-dim: #cbd5e1;
            --border: #334155;
            --accent: #f59e42;
        }
        * { margin: 0; padding: 0; box-sizing: border-box;}
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        .nav {background: var(--card);border-bottom: 1px solid var(--border);padding: 1rem 1.5rem;position: sticky;top: 0;z-index: 100;}
        .nav-content {max-width: 1400px;margin: 0 auto;display: flex;justify-content: space-between;align-items: center;}
        .nav-brand {font-size: 1.5rem;font-weight: 800;background: var(--gradient);-webkit-background-clip: text;-webkit-text-fill-color: transparent;}
        .nav-toggle {display: none;background: none;border: none;color: var(--primary);font-size: 1.5rem;cursor:pointer;padding: 0.5rem;}
        .nav-menu {display: flex;gap: 0.5rem;list-style: none;}
        .nav-menu a {padding: 0.6rem 1.2rem;border-radius: 8px;text-decoration: none;color: var(--text-dim);font-weight: 600;font-size: 0.95rem;transition: all 0.2s;}
        .nav-menu a:hover {background: rgba(102,126,234,0.1);color: var(--primary);}
        .nav-menu a.active {background: var(--gradient);color: white;}
        @media (max-width: 768px) {
            .nav-toggle {display: block;}
            .nav-menu {
                position: fixed;top: 70px;left: 0;right: 0;
                background: var(--card);flex-direction: column;padding: 1rem;
                transform: translateY(-100%);
                opacity: 0;pointer-events: none;transition: all 0.3s;
            }
            .nav-menu.active {transform: translateY(0);opacity: 1;pointer-events: all;}
            .nav-menu a {width: 100%;}
        }
        .container {max-width: 1400px;margin: 0 auto;padding: 2rem 1.5rem;}
        .header {display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:2rem;margin-bottom:2rem;}
        h1 {font-size:2rem;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0;}
        .todays-date {font-size:1.09rem;color:var(--text-dim);font-weight:500;margin-bottom:6px;}
        .dashboard-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(380px,1fr));gap:2rem;}
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.4rem 1.2rem 1rem 1.2rem;
            box-shadow: 0 0 6px rgba(0,0,0,0.03);
            min-height: 215px;
            position: relative;
        }
        .card-title {
            font-size: 1.13rem;font-weight: 700; margin-bottom: 0.7rem;background: var(--gradient);-webkit-background-clip: text;-webkit-text-fill-color: transparent;
        }
        .card-link {float:right;text-decoration:none;color: var(--accent);font-size:1.04rem;}
        .list-group {margin-bottom:1rem;}
        .list-group li {margin-bottom:0.57rem;}
        .empty {color:var(--text-dim); font-size:1.04rem;}
        .meal-title {font-weight:700; background:var(--gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent;}
        .tag {
            display:inline-block; padding:0.20em 0.8em; border-radius:6px; 
            font-size:0.92em; background:rgba(102,126,234,0.09);color:var(--primary);
            margin:0 0.25em 0.27em 0; text-transform:capitalize;border:1px solid var(--border);
        }
        .tag-type {background:rgba(102,126,234,0.17);color:#93c5fd;border:1px solid rgba(102,126,234,0.26);}
        .tag-area {background:rgba(245,158,66,0.13);color:#f59e42;border:1px solid rgba(245,158,66,0.25);}
        .btn {
            padding: 0.65rem 1.2rem;
            border-radius: 7px;
            font-weight: 600;
            cursor:pointer;
            border: none;
            background: var(--gradient); color: white;
            transition: all 0.2s;
        }
        .btn:hover {transform:translateY(-1px);}
        .quick-add-form {display: flex; gap:0.25em; flex-wrap:wrap;align-items:center;margin-top:0.4em;}
        .quick-add-form input[type=text], .quick-add-form input[type=number], .quick-add-form select {
            padding:0.46rem 0.85rem; border:2px solid var(--border); border-radius:7px; background:var(--bg);color:var(--text);font-size:1rem;}
        .quick-add-form input[type=number]{max-width:65px;}
        .quick-add-form .btn {padding:0.5rem 1.3rem;}
    </style>
</head>
<body>
<nav class="nav">
    <div class="nav-content">
        <div class="nav-brand">üè† Home Hub</div>
        <button class="nav-toggle" onclick="document.getElementById('navMenu').classList.toggle('active')">‚ò∞</button>
        <ul class="nav-menu" id="navMenu">
            <li><a href="pages/meals.html">üçΩÔ∏è Meals</a></li>
            <li><a href="pages/planner.html">üìÖ Planner</a></li>
            <li><a href="pages/shopping.html">üõí Shopping</a></li>
            <li><a href="pages/cleaning.html">üßπ Cleaning</a></li>
            <li><a href="pages/maintenance.html">üõ†Ô∏è Maintenance</a></li>
            <li><a href="pages/settings.html">‚öôÔ∏è Settings</a></li>
        </ul>
    </div>
</nav>
<div class="container">
    <div class="header">
        <h1>Home Hub Dashboard</h1>
        <div class="todays-date" id="dateToday"></div>
    </div>
    <div class="dashboard-grid">
        <div class="card">
            <div class="card-title">üçΩÔ∏è Meals Today <a href="meals.html" class="card-link">View meals</a></div>
            <ul class="list-group" id="mealsToday"></ul>
        </div>
        <div class="card">
            <div class="card-title">üßπ Cleaning Tasks Today <a href="cleaning.html" class="card-link">View cleaning</a></div>
            <ul class="list-group" id="cleaningToday"></ul>
        </div>
        <div class="card">
            <div class="card-title">üõ†Ô∏è Maintenance Tasks Today <a href="maintenance.html" class="card-link">View maintenance</a></div>
            <ul class="list-group" id="maintenanceToday"></ul>
        </div>
        <div class="card">
            <div class="card-title">üõí Shopping List <a href="shopping.html" class="card-link">View shopping</a></div>
            <ul class="list-group" id="shoppingPreview"></ul>
            <form class="quick-add-form" onsubmit="addQuickShopping(event)">
                <input type="text" id="quickItem" placeholder="Item (e.g. Apples)" required>
                <input type="number" id="quickQty" min="1" value="1" required>
                <select id="quickUnit" style="width:auto">
                    <option value="">x</option>
                    <option value="g">g</option>
                    <option value="kg">kg</option>
                    <option value="ml">ml</option>
                    <option value="l">l</option>
                </select>
                <button class="btn" type="submit">Add to Shopping</button>
            </form>
        </div>
    </div>
</div>
<script>
const WEEKDAYS = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
const MONTHS = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
function formatToday(){
    let d=new Date(), day=WEEKDAYS[d.getDay()], date=d.getDate(), month=MONTHS[d.getMonth()], year=d.getFullYear();
    return `${day}, ${date} ${month} ${year}`;
}
document.getElementById("dateToday").textContent = formatToday();

// Meals today
function renderMealsToday(){
    let plannerData = JSON.parse(localStorage.getItem('hubPlanner')||"[]");
    let today = new Date();
    let idx = today.getDay(); // Assuming 0=Sunday, 1=Monday, etc
    let mealEls = document.getElementById("mealsToday");
    mealEls.innerHTML = '';
    if(plannerData && plannerData[idx] && plannerData[idx].meal){
        let meal = plannerData[idx].meal;
        mealEls.innerHTML = `<li>
            <span class="meal-title">${meal.t||meal.title||"Meal"}</span>
            ${meal.type?`<span class="tag tag-type">${meal.type}</span>`:""}
            ${meal.diet && meal.diet.length ? meal.diet.map(d=>`<span class="tag tag-type">${d.replace('-',' ')}</span>`).join(''):''}
            <br>
            <small style="color:var(--text-dim);">Ingredients: ${meal.ing?meal.ing.join(", "):"N/A"}</small>
        </li>`;
    } else {
        mealEls.innerHTML = '<li class="empty">No meal planned for today.</li>';
    }
}

// Cleaning today
function renderCleaningToday(){
    let cleaningData = JSON.parse(localStorage.getItem('hubCleaning')||"[]");
    let tasksToday = cleaningData.filter(t=>{
        // For simplicity, just assuming daily tasks, can be improved:
        if(!t.active) return false;
        if(t.freq=="daily") return true;
        // Weekly: show on task day (assumes Monday start)
        let today=new Date(), weekday=WEEKDAYS[today.getDay()].toLowerCase();
        if(t.freq=="weekly" && t.day && t.day.toLowerCase()==weekday) return true;
        return false;
    });
    let cleaningEls = document.getElementById("cleaningToday");
    cleaningEls.innerHTML = '';
    if(tasksToday.length){
        cleaningEls.innerHTML = tasksToday.map(t=>
            `<li>
                <span>${t.title}</span>
                ${t.room?`<span class="tag tag-area">${t.room}</span>`:""}
            </li>`
        ).join('');
    } else {
        cleaningEls.innerHTML = '<li class="empty">No cleaning tasks due today.</li>';
    }
}

// Maintenance today
function renderMaintenanceToday(){
    let maintenanceData = JSON.parse(localStorage.getItem('hubMaintenance')||"[]");
    let todayStr = (new Date()).toISOString().split("T")[0];
    let mtEls = document.getElementById("maintenanceToday");
    let tasksToday = maintenanceData.filter(t=>t.active && t.due===todayStr && !t.history.includes(todayStr));
    mtEls.innerHTML = '';
    if(tasksToday.length){
        mtEls.innerHTML = tasksToday.map(t=>`
            <li>
                <span>${t.title}</span>
                ${t.area?`<span class="tag tag-area">${t.area}</span>`:""}
            </li>
        `).join('');
    } else {
        mtEls.innerHTML = '<li class="empty">No maintenance tasks due today.</li>';
    }
}

// Shopping preview
function renderShoppingPreview(){
    let shoppingData = JSON.parse(localStorage.getItem('hubShopping')||"[]");
    let list = document.getElementById("shoppingPreview");
    let preview = shoppingData.slice(0,5); // Show top 5 items
    list.innerHTML = '';
    if(preview.length){
        list.innerHTML = preview.map(i=>`
            <li>
                <span>${i.name}</span>
                ${i.qty>1?`<span class="tag">x${i.qty}${i.unit?i.unit:''}</span>`:""}
                ${i.fav?'<span class="item-fav" title="Favourite">‚≠ê</span>':''}
            </li>
        `).join('');
        if(shoppingData.length>5){
            list.innerHTML += `<li class="empty"><a href="shopping.html" style="color:var(--accent);text-decoration:underline;">View all items...</a></li>`;
        }
    } else {
        list.innerHTML = '<li class="empty">Shopping list is empty.</li>';
    }
}

// Quick add shopping
function addQuickShopping(e){
    e.preventDefault();
    let name = document.getElementById("quickItem").value.trim();
    let qty = parseInt(document.getElementById("quickQty").value)||1;
    let unit = document.getElementById("quickUnit").value;
    if(name){
        let shoppingData = JSON.parse(localStorage.getItem('hubShopping')||"[]");
        let idx = shoppingData.findIndex(i=>i.name.toLowerCase()===name.toLowerCase() && ((i.unit||"")==unit));
        if(idx>=0){
            shoppingData[idx].qty = (shoppingData[idx].qty||1) + qty;
            shoppingData[idx].unit = unit;
        } else {
            shoppingData.push({name, qty, unit, fav:false, checked:false});
        }
        localStorage.setItem('hubShopping', JSON.stringify(shoppingData));
        renderShoppingPreview();
    }
    document.getElementById("quickItem").value = '';
    document.getElementById("quickQty").value = 1;
    document.getElementById("quickUnit").value = '';
}

// Initial render
renderMealsToday();
renderCleaningToday();
renderMaintenanceToday();
renderShoppingPreview();
</script>
</body>
</html>
