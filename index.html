<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home Management Hub - Dashboard</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <style>
        :root {
            --primary: #667eea;
            --primary-dark: #764ba2;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 98%);
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --text-dim: #cbd5e1;
            --border: #334155;
        }
        body { font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif; background: var(--bg); color: var(--text);}
        .nav { background: var(--card); border-bottom: 1px solid var(--border); padding: 1rem 1.5rem; position: sticky; top: 0; z-index: 100;}
        .nav-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;}
        .nav-brand { font-size: 1.5rem; font-weight: 800; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;}
        .nav-toggle { display: none; background: none; border: none; color: var(--primary); font-size: 1.5rem; cursor: pointer; padding: 0.5rem;}
        .nav-menu { display: flex; gap: 0.5rem; list-style: none;}
        .nav-menu a { padding: 0.6rem 1.2rem; border-radius: 8px; text-decoration: none; color: var(--text-dim); font-weight: 600; font-size: 0.95rem; transition: all 0.2s;}
        .nav-menu a:hover { background: rgba(102, 126, 234, 0.1); color: var(--primary);}
        .nav-menu a.active { background: var(--gradient); color: white;}
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem 1.5rem;}
        h1 { font-size: 2rem; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0 0 1rem 0;}
        .dashboard-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(330px,1fr)); gap:2rem; margin-top:2rem;}
        .card { background: var(--card); border:1px solid var(--border); border-radius:12px; padding:1.2rem 1.6rem 1.4rem 1.6rem; position:relative;}
        .card-title {font-weight:700; font-size:1.1rem; margin-bottom:0.5em; background: var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
        .card-list {list-style:none; padding:0; margin:0;}
        .card-list li {margin-bottom: 0.75em;}
        .tasks-today-empty {padding:1.5em; color:var(--text-dim;}
        .today-date {font-size:1.15em; color:var(--primary);}
        .card-actions {margin-top:1rem;}
        .card-actions a {color:var(--primary); font-weight:600; text-decoration:none; border-radius:6px; padding:5px 20px; background: var(--gradient); color:white; margin-right:0.4em;}
        .card-actions a:hover {background:var(--primary-dark); color:white;}
        @media (max-width: 950px){
            .dashboard-grid {grid-template-columns:1fr;}
            .container {padding:1.2rem 0.2rem;}
        }
        @media (max-width: 768px) {
            .nav-toggle { display: block;}
            .nav-menu { position: fixed; top: 70px; left: 0; right: 0; background: var(--card); flex-direction: column; padding: 1rem; transform: translateY(-100%); opacity: 0; pointer-events: none; transition: all 0.3s;}
            .nav-menu.active { transform: translateY(0); opacity: 1; pointer-events: all;}
            .nav-menu a { width: 100%;}
        }
        .welcome-msg {color: var(--text-dim); margin-top:-0.5em; margin-bottom:1.5em;}
        .overview-row {display:flex; gap:1em; flex-wrap:wrap;}
        .overview-card {background:var(--gradient); color:white; border-radius:9px; padding:1.1em 2em; min-width:160px; box-shadow:0 2px 7px rgba(102,126,234,0.05);}
        .overview-value {font-size:2em; font-weight:800;}
        .overview-label {font-size:1em; font-weight:600; letter-spacing:0.03em;}
        .empty-icon { font-size: 2.7rem; margin-bottom: 0.4rem; opacity: 0.4;}
        a.cleaning-btn { background:var(--gradient); color:white; text-decoration:none; padding:7px 18px; border-radius:7px; display:inline-block; margin-top:1em; font-weight:600;}
        a.cleaning-btn:hover {background:var(--primary-dark); color:white;}

    </style>
</head>
<body>
<nav class="nav">
    <div class="nav-content">
        <div class="nav-brand">üè† Home Hub</div>
        <button class="nav-toggle" onclick="document.getElementById('navMenu').classList.toggle('active')">‚ò∞</button>
        <ul class="nav-menu" id="navMenu">
            <li><a href="index.html" class="active">üìä Dashboard</a></li>
            <li><a href="pages/meals.html">üçΩÔ∏è Meals</a></li>
            <li><a href="pages/planner.html">üìÖ Planner</a></li>
            <li><a href="pages/shopping.html">üõí Shopping</a></li>
            <li><a href="pages/cleaning.html">üßπ Cleaning</a></li>
            <li><a href="pages/maintenance.html">üõ†Ô∏è Maintenance</a></li>
            <li><a href="pages/settings.html">‚öôÔ∏è Settings</a></li>
        </ul>
    </div>
</nav>
<div class="container">
    <h1>Welcome back!</h1>
    <div class="welcome-msg">Here is what‚Äôs on today and a quick snapshot of your home hub.</div>

    <!-- Overview summary cards -->
    <div class="overview-row" id="overviewRow">
        <div class="overview-card">
            <div class="overview-value" id="overviewTasks"></div>
            <div class="overview-label">Cleaning Tasks Today</div>
        </div>
        <div class="overview-card">
            <div class="overview-value" id="overviewMeals"></div>
            <div class="overview-label">Meals Planned</div>
        </div>
        <div class="overview-card">
            <div class="overview-value" id="overviewShopping"></div>
            <div class="overview-label">Shopping Items</div>
        </div>
    </div>

    <div class="dashboard-grid" style="margin-top:2.2em;">
        <!-- Today's Cleaning Tasks -->
        <div class="card">
            <div class="card-title">Today's Cleaning Tasks</div>
            <div><span class="today-date" id="todayDate"></span></div>
            <ul class="card-list" id="tasksTodayList"></ul>
            <div class="tasks-today-empty" id="tasksTodayEmpty" style="display:none;">
                <span class="empty-icon">üßπ</span><br>
                You have no cleaning tasks scheduled for today!
            </div>
            <a class="cleaning-btn" href="pages/cleaning.html">View Cleaning Calendar</a>
        </div>
        <!-- Meals Planned Card -->
        <div class="card">
            <div class="card-title">Meals Planned for Today</div>
            <div><span class="today-date" id="todayDateMeals"></span></div>
            <ul class="card-list" id="mealsTodayList"></ul>
            <div class="tasks-today-empty" id="mealsTodayEmpty" style="display:none;">
                <span class="empty-icon">üçΩÔ∏è</span><br>
                No meals planned yet.
            </div>
            <a class="cleaning-btn" href="pages/meals.html">See Meal Planner</a>
        </div>
        <!-- Shopping List Card -->
        <div class="card">
            <div class="card-title">Shopping List</div>
            <ul class="card-list" id="dashboardShoppingList"></ul>
            <div class="tasks-today-empty" id="dashboardShoppingEmpty" style="display:none;">
                <span class="empty-icon">üõí</span><br>
                Your shopping list is empty!
            </div>
            <a class="cleaning-btn" href="pages/shopping.html">Edit Shopping List</a>
        </div>
    </div>
</div>
<script>
// Set today's date visual
function formatTodayDate() {
    let today = new Date();
    let month = today.toLocaleString('default',{month:'short'});
    let weekday = today.toLocaleString('default',{weekday:'short'});
    let dateStr = `${weekday}, ${today.getDate()} ${month} ${today.getFullYear()}`;
    document.getElementById("todayDate").textContent = dateStr;
    document.getElementById("todayDateMeals").textContent = dateStr;
}
formatTodayDate();

// Cleaning tasks for today from cleaning.html pushed to window.todayCleaningTasks
function getCleaningTasksToday() {
    // Try calendar save, fallback to window.todayCleaningTasks if set by cleaning.html
    let d = new Date();
    let yyyy = d.getFullYear(), mm=String(d.getMonth()+1).padStart(2,'0'), dd=String(d.getDate()).padStart(2,'0');
    let todayKeyAM = `${yyyy}-${mm}-${dd}_AM`;
    let todayKeyPM = `${yyyy}-${mm}-${dd}_PM`;

    let calendarTasks = [];
    let stored = localStorage.getItem('hmhCleaningCalendarTasks');
    if (stored) {
        let calendar = JSON.parse(stored)
        let am = calendar.find(c=>c.date===`${yyyy}-${mm}-${dd}`&&c.part==="AM");
        let pm = calendar.find(c=>c.date===`${yyyy}-${mm}-${dd}`&&c.part==="PM");
        if(am) calendarTasks = calendarTasks.concat(am.tasks.map(t=>t.title));
        if(pm) calendarTasks = calendarTasks.concat(pm.tasks.map(t=>t.title));
    }
    // window.todayCleaningTasks fallback
    if(calendarTasks.length==0 && window.todayCleaningTasks) calendarTasks = window.todayCleaningTasks;
    return calendarTasks;
}
function renderCleaningTasksToday() {
    let arr = getCleaningTasksToday();
    document.getElementById("overviewTasks").textContent = arr.length;
    let ul = document.getElementById("tasksTodayList");
    let empty = document.getElementById("tasksTodayEmpty");
    if(!arr || arr.length===0){
        ul.innerHTML = "";
        empty.style.display="block";
    }else{
        ul.innerHTML = arr.map(t=>`<li>üßπ ${t}</li>`).join('');
        empty.style.display="none";
    }
}

function getMealsToday() {
    // Try to load from localStorage (hmhMealsList)
    // Example structure: [{date: "2025-11-12", meal: "Spaghetti Bolognese"}, ...]
    let d = new Date();
    let todayStr = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    let list = [];
    let stored = localStorage.getItem('hmhMealsList');
    if(stored){
        try{
            let meals = JSON.parse(stored).filter(m=>m.date==todayStr);
            list = meals.map(m=>m.meal);
        }catch{}
    }
    return list;
}
function renderMealsToday(){
    let arr = getMealsToday();
    document.getElementById("overviewMeals").textContent = arr.length;
    let ul = document.getElementById("mealsTodayList");
    let empty = document.getElementById("mealsTodayEmpty");
    if(!arr || arr.length==0){
        ul.innerHTML = "";
        empty.style.display="block";
    }else{
        ul.innerHTML = arr.map(m=>`<li>üçΩÔ∏è ${m}</li>`).join('');
        empty.style.display="none";
    }
}
function getShoppingItems(){
    let stored = localStorage.getItem('hmhShoppingList');
    let arr = stored ? JSON.parse(stored) : [];
    return arr;
}
function renderShoppingDashboard(){
    let arr = getShoppingItems();
    document.getElementById("overviewShopping").textContent = arr.length;
    let ul = document.getElementById("dashboardShoppingList");
    let empty = document.getElementById("dashboardShoppingEmpty");
    if(!arr || arr.length==0){
        ul.innerHTML = "";
        empty.style.display="block";
    }else{
        ul.innerHTML = arr.map(m=>`<li>üõí ${m}</li>`).join('');
        empty.style.display="none";
    }
}
document.addEventListener("DOMContentLoaded",()=>{
    renderCleaningTasksToday();
    renderMealsToday();
    renderShoppingDashboard();
});
</script>
</body>
</html>
