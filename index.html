<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home Management Hub - Dashboard</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <style>
        :root {
            --primary: #667eea;
            --primary-dark: #764ba2;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 98%);
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --text-dim: #cbd5e1;
            --border: #334155;
            --accent: #a78bfa;
            --link: #a78bfa;
            --link-hover: #fafcff;
            --danger: #ef4444;
        }
        body { font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif; background: var(--bg); color: var(--text);}
        .nav { background: var(--card); border-bottom: 1px solid var(--border); padding: 1rem 1.5rem; position: sticky; top: 0; z-index: 100;}
        .nav-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;}
        .nav-brand { font-size: 1.5rem; font-weight: 800; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;}
        .nav-toggle { display: none; background: none; border: none; color: var(--primary); font-size: 1.5rem; cursor: pointer; padding: 0.5rem;}
        .nav-menu { display: flex; gap: 0.5rem; list-style: none;}
        .nav-menu a { padding: 0.6rem 1.2rem; border-radius: 8px; text-decoration: none; color: var(--text-dim); font-weight: 600; font-size: 0.95rem; transition: all 0.2s;}
        .nav-menu a:hover { background: rgba(102, 126, 234, 0.1); color: var(--primary);}
        .nav-menu a.active { background: var(--gradient); color: white;}
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem 1.5rem;}
        h1 { font-size: 2rem; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0 0 1rem 0;}
        .welcome-msg {color: var(--text-dim); margin-top:-0.5em; margin-bottom:1.5em;}
        .dashboard-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(330px,1fr)); gap:2rem; margin-top:2.2em;}
        .card { background: var(--card); border:1px solid var(--border); border-radius:12px; padding:1.45rem 1.55rem 1.7rem 1.55rem; position:relative;}
        .card-title {font-weight:700; font-size:1.18rem; margin-bottom:0.6em; color: var(--accent); letter-spacing:.01em;}
        .card-list {list-style:none; padding:0; margin:0;}
        .card-list li {margin-bottom: 0.73em;}
        .tasks-today-empty {padding:1.3em 0.2em; color:var(--text);}
        .today-date {font-size:1.04em; color:var(--primary); margin-bottom:10px;}
        .card-actions {margin-top:1.1rem;}
        .card-actions a, .card-actions button, .card-link {
            color: var(--card);
            font-weight: 600;
            text-decoration: underline;
            background: var(--accent);
            padding: 7px 21px;
            border-radius: 7px;
            font-size: 1.02em;
            display:inline-block;
            margin-top: .7em;
            border: none;
            transition: background .2s, color .2s;
            outline: none;
            cursor: pointer;
        }
        .card-link { text-decoration: underline; background: var(--accent);}
        .card-actions a:hover, .card-link:hover, .card-actions button:hover { background: var(--link-hover); color: var(--primary-dark); }
        .empty-icon { font-size: 2.7rem; margin-bottom: 0.4rem; opacity: 0.32;}
        @media (max-width: 950px){
            .dashboard-grid {grid-template-columns:1fr;}
            .container {padding:1.2rem 0.2rem;}
        }
        @media (max-width: 768px) {
            .nav-toggle { display: block;}
            .nav-menu { position: fixed; top: 70px; left: 0; right: 0; background: var(--card); flex-direction: column; padding: 1rem; transform: translateY(-100%); opacity: 0; pointer-events: none; transition: all 0.3s;}
            .nav-menu.active { transform: translateY(0); opacity: 1; pointer-events: all;}
            .nav-menu a { width: 100%;}
            .dashboard-grid {gap:1rem;}
            .card { padding:1.05rem .7rem 1.22rem .7rem;}
        }
        /* Accessibility fixes for links/buttons at card bottom */
        .card-link, .card-actions a, .card-actions button {
            box-shadow: 0 1px 3px 0 rgba(102,126,234,0.04);
            border: 2px solid transparent;
            font-family: inherit;
        }
        .card-link:focus, .card-actions a:focus, .card-actions button:focus {
            border: 2px solid var(--primary);
            outline: none;
        }
    </style>
</head>
<body>
<nav class="nav" aria-label="main navigation">
    <div class="nav-content">
        <div class="nav-brand">üè† Home Hub</div>
        <button class="nav-toggle" aria-label="Open menu" onclick="document.getElementById('navMenu').classList.toggle('active')">‚ò∞</button>
        <ul class="nav-menu" id="navMenu">
            <li><a href="index.html" class="active" aria-current="page">üìä Dashboard</a></li>
            <li><a href="pages/meals.html">üçΩÔ∏è Meals</a></li>
            <li><a href="pages/planner.html">üìÖ Planner</a></li>
            <li><a href="pages/shopping.html">üõí Shopping</a></li>
            <li><a href="pages/cleaning.html">üßπ Cleaning</a></li>
            <li><a href="pages/maintenance.html">üõ†Ô∏è Maintenance</a></li>
            <li><a href="pages/settings.html">‚öôÔ∏è Settings</a></li>
        </ul>
    </div>
</nav>
<div class="container">
    <h1>Welcome back!</h1>
    <div class="welcome-msg">Here is what‚Äôs on today and a quick snapshot of your home hub.</div>
    <div class="dashboard-grid">
        <!-- Today's Cleaning Tasks -->
        <section class="card" aria-labelledby="cleaningTasksTitle">
            <div class="card-title" id="cleaningTasksTitle">Today's Cleaning Tasks</div>
            <div><span class="today-date" id="todayDate"></span></div>
            <ul class="card-list" id="tasksTodayList"></ul>
            <div class="tasks-today-empty" id="tasksTodayEmpty" style="display:none;">
                <span class="empty-icon">üßπ</span><br>
                You have no cleaning tasks scheduled for today!
            </div>
            <div class="card-actions">
                <a class="card-link" href="pages/cleaning.html">View Cleaning Calendar</a>
            </div>
        </section>
        <!-- Meals Planned Card -->
        <section class="card" aria-labelledby="mealsTodayTitle">
            <div class="card-title" id="mealsTodayTitle">Meals Planned for Today</div>
            <div><span class="today-date" id="todayDateMeals"></span></div>
            <ul class="card-list" id="mealsTodayList"></ul>
            <div class="tasks-today-empty" id="mealsTodayEmpty" style="display:none;">
                <span class="empty-icon">üçΩÔ∏è</span><br>
                No meals planned yet.
            </div>
            <div class="card-actions">
                <a class="card-link" href="pages/meals.html">See Meal Planner</a>
            </div>
        </section>
        <!-- Shopping List Card -->
        <section class="card" aria-labelledby="shoppingListTitle">
            <div class="card-title" id="shoppingListTitle">Shopping List</div>
            <ul class="card-list" id="dashboardShoppingList"></ul>
            <div class="tasks-today-empty" id="dashboardShoppingEmpty" style="display:none;">
                <span class="empty-icon">üõí</span><br>
                Your shopping list is empty!
            </div>
            <div class="card-actions">
                <a class="card-link" href="pages/shopping.html">Edit Shopping List</a>
            </div>
        </section>
    </div>
</div>
<script>
// Set today's date visual
function formatTodayDate() {
    let today = new Date();
    let month = today.toLocaleString('default',{month:'short'});
    let weekday = today.toLocaleString('default',{weekday:'short'});
    let dateStr = `${weekday}, ${today.getDate()} ${month} ${today.getFullYear()}`;
    document.getElementById("todayDate").textContent = dateStr;
    document.getElementById("todayDateMeals").textContent = dateStr;
}
formatTodayDate();

// Cleaning tasks for today from cleaning.html pushed to window.todayCleaningTasks
function getCleaningTasksToday() {
    // Try calendar save, fallback to window.todayCleaningTasks if set by cleaning.html
    let d = new Date();
    let yyyy = d.getFullYear(), mm=String(d.getMonth()+1).padStart(2,'0'), dd=String(d.getDate()).padStart(2,'0');
    let calendarTasks = [];
    let stored = localStorage.getItem('hmhCleaningCalendarTasks');
    if (stored) {
        let calendar = JSON.parse(stored)
        let am = calendar.find(c=>c.date===`${yyyy}-${mm}-${dd}`&&c.part==="AM");
        let pm = calendar.find(c=>c.date===`${yyyy}-${mm}-${dd}`&&c.part==="PM");
        if(am) calendarTasks = calendarTasks.concat(am.tasks.map(t=>t.title));
        if(pm) calendarTasks = calendarTasks.concat(pm.tasks.map(t=>t.title));
    }
    // window.todayCleaningTasks fallback
    if(calendarTasks.length==0 && window.todayCleaningTasks) calendarTasks = window.todayCleaningTasks;
    return calendarTasks;
}
function renderCleaningTasksToday() {
    let arr = getCleaningTasksToday();
    let ul = document.getElementById("tasksTodayList");
    let empty = document.getElementById("tasksTodayEmpty");
    if(!arr || arr.length===0){
        ul.innerHTML = "";
        empty.style.display="block";
    }else{
        ul.innerHTML = arr.map(t=>`<li>üßπ ${t}</li>`).join('');
        empty.style.display="none";
    }
}

function getMealsToday() {
    // Try to load from localStorage (hmhMealsList)
    // Example structure: [{date: "2025-11-12", meal: "Spaghetti Bolognese"}, ...]
    let d = new Date();
    let todayStr = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    let list = [];
    let stored = localStorage.getItem('hmhMealsList');
    if(stored){
        try{
            let meals = JSON.parse(stored).filter(m=>m.date==todayStr);
            list = meals.map(m=>m.meal);
        }catch{}
    }
    return list;
}
function renderMealsToday(){
    let arr = getMealsToday();
    let ul = document.getElementById("mealsTodayList");
    let empty = document.getElementById("mealsTodayEmpty");
    if(!arr || arr.length==0){
        ul.innerHTML = "";
        empty.style.display="block";
    }else{
        ul.innerHTML = arr.map(m=>`<li>üçΩÔ∏è ${m}</li>`).join('');
        empty.style.display="none";
    }
}
function getShoppingItems(){
    let stored = localStorage.getItem('hmhShoppingList');
    let arr = stored ? JSON.parse(stored) : [];
    return arr;
}
function renderShoppingDashboard(){
    let arr = getShoppingItems();
    let ul = document.getElementById("dashboardShoppingList");
    let empty = document.getElementById("dashboardShoppingEmpty");
    if(!arr || arr.length==0){
        ul.innerHTML = "";
        empty.style.display="block";
    }else{
        ul.innerHTML = arr.map(m=>`<li>üõí ${m}</li>`).join('');
        empty.style.display="none";
    }
}
document.addEventListener("DOMContentLoaded",()=>{
    renderCleaningTasksToday();
    renderMealsToday();
    renderShoppingDashboard();
});
</script>
</body>
</html>
